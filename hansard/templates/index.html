{% extends "base.html" %}
{% block title %}Index{% endblock %}
{% block head %}
  {{ super() }}
  <style type="text/css">
  </style>
{% endblock %}

{% block content %}
<h2>What Do MPs Say in the House of Commons?</h2>
<span class="help-block">Analysis by <a href="http://www.alchemyapi.com/">AlchemyAPI</a></span>
<form id="input">
	<label for="type">
		Type:
	</label>
	<select id="type" name="type">
	  <option value="any">Any</option>
	  <option value="mps">MP</option>
	  <option value="quotations">Quotation</option>
	</select>
	
	<!--
	<label for="sample">
		Sample:
	</label>
	<select id="sample" name="sample">
	  <option value="repitition">Repitition</option>
	  <option value="relevance">Relevance</option>
	</select>
	-->
	<!-- QUOTATION INFO -->
	<!--
	<label for="language">
		Language:
	</label>
	<select id="language" name="language">
	  <option value="any">Any</option>
	  <option value="en">EN</option>
	  <option value="fr">FR</option>
	  <option value="other">Other</option>
	</select>
	
	
	<label for="date-from">
		Date From:
	</label>
	<input name="date-from" type="date">
	
	<label for="date-to">
		Date To:
	</label>
	<input name="date-to" type="date">
	
	-->

	<!-- MP INFO -->
	<!--
	<label for="party">
		Party:
	</label>
	<select id="party" name="party">
	  <option value="any">Any</option>
	  <option value="lpc">LPC</option>
	  <option value="cpc">CPC</option>
	  <option value="npd">NDP</option>
	  <option value="bq">BQ</option>
	  <option value="gpc">GPC</option>
	  <option value="other">Other</option>
	</select>
	-->
	
	<label for="search">
		Search For:
	</label>
	<input name="search" type="search">
	
	<label for="search_type">
		Search Type:
	</label>
	<select id="search_type" name="search_type">
	  <option value="any">Any</option>
	  <option value="entity">Entity</option>
	  <option value="keyword">Keyword</option>
	</select>

	<input id="query-btn" type="submit" value="Query">
</form>

<script type="text/template" class="entities_template">
	
	<table class="table table-striped">
		<tr>
			<th>type</th>
			<th>relevance</th>
			<th>text</th>
			<th>sentiment</th>
			<th>score</th>
		</tr>
		<% _.each(obj, function(data, index) { %>
			<tr>
				<td class="type"><%= data.type %></td>
				<td class="relevance"><%= data.relevance %></td>
				<td class="text"><%= data.text %></td>
				<td class="sentiment"><%= data.sentiment %></td>
				<td class="score"><%= data.score %></td>
			</tr>
		<% }); %>
	</table>
	<br />
</script>

<script type="text/javascript">
	
	$(document).on('submit', 'form', function(e) {
		e.preventDefault();
		var params = $(this).serialize();
		console.log( params );
		var compiled = _.template($('.entities_template').html());
		$.ajax({
			url : 'search?' + params,
			type: "GET",
			dataType: 'json',
			success : function(response) {
				var $result = $("#result");
				$result.html("");
				$result.append(compiled(response.e));
				$result.append(compiled(response.k));
				
			}
		});
		return false;
	});
</script>

<div id="result">
</div>
{% endblock %}